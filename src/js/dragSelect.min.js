var isReduce=false;function clearSelections(){if(window.getSelection){var selection=window.getSelection();selection.removeAllRanges()}else{if(document.selection&&document.selection.empty){document.selection.empty()}}}function getEleOffsetLeft(option,ele){ele=ele||document.body;var left=0;if(option!=ele&&option.offsetParent){left+=getEleOffsetLeft(option.offsetParent,ele)}left+=option.offsetLeft;return left}function getEleOffsetTop(option,ele){ele=ele||document.body;var top=0;if(option!=ele&&option.offsetParent){top+=getEleOffsetTop(option.offsetParent,ele)}top+=option.offsetTop;return top}function getEleScrollLeft(option,ele){ele=ele||document.body;var left=0;if(option!=ele&&option.parentNode){left+=getEleScrollLeft(option.parentNode,ele)}left+=option.scrollLeft;return left}function getEleScrollTop(option,ele){ele=ele||document.body;var top=0;if(option!=ele&&option.parentNode){top+=getEleScrollTop(option.parentNode,ele)}top+=option.scrollTop;return top}function getDS(){var shade=null;shade=document.createElement("i");shade.style.position="absolute";shade.className="ds-shade";var sX=0;var sY=0;var eX=0;var eY=0;var eleList=[];var vList=[];var valueKey="value";function getOption(ele){if(ele&&ele.getElementsByClassName){return ele.getElementsByClassName("ds-option")}return[]}function resetLastFocus(ele,option){var lastArr=ele.getElementsByClassName("last-focus");for(var i=0;i<lastArr.length;i++){lastArr[i].classList.remove("last-focus")}option.classList.add("last-focus")}function addSelect(eleArr,beginEle,endEle){var begin=null;var end=null;var arr=[];for(var i=0;i<eleArr.length;i++){const item=eleArr[i];if(beginEle==item){begin=i}if(begin!=null){arr.push(item)}if(endEle==item){end=i;break}}if(end!=null){for(var i=0;i<arr.length;i++){arr[i].classList.add("ds-checked")}}}function setShage(e,ele){eX=e.pageX-getEleOffsetLeft(ele)+getEleScrollLeft(ele)-(isReduce?window.scrollX:0);eY=e.pageY-getEleOffsetTop(ele)+getEleScrollTop(ele)-(isReduce?window.scrollY:0);shade.style.left=sX+"px";shade.style.top=sY+"px";shade.style.width=Math.abs(eX-sX)+"px";shade.style.height=Math.abs(eY-sY)+"px";var shadeX1=sX;var shadeY1=sY;var shadeX2=eX;var shadeY2=eY;if(eX-sX<0){shade.style.left=eX+"px";shadeX1=eX;shadeX2=sX}if(eY-sY<0){shade.style.top=eY+"px";shadeY1=eY;shadeY2=sY}var arr=getOption(ele);var lastFocus=null;var startFocus=null;for(var i=0;i<arr.length;i++){var option=arr[i];var x1=option.offsetLeft;var y1=option.offsetTop;var x2=option.offsetLeft+option.clientWidth;var y2=option.offsetTop+option.clientHeight;if(option.classList.contains("last-focus")){lastFocus=option}if((shadeX1<=x1&&shadeX2>=x2&&shadeY1<=y1&&shadeY2>=y2)||(shadeX1>=x1&&shadeX2<=x2&&shadeY1>=y1&&shadeY2<=y2)||(((shadeY1<=y1&&shadeY2>=y1)||(shadeY1<=y2&&shadeY2>=y2))&&((shadeX1>=x1&&shadeX1<=x2)||(shadeX2>=x1&&shadeX2<=x2)))||(((shadeX1<=x1&&shadeX2>=x1)||(shadeX1<=x2&&shadeX2>=x2))&&((shadeY1>=y1&&shadeY1<=y2)||(shadeY2>=y1&&shadeY2<=y2)))){if(e.shiftKey){if(lastFocus){addSelect(arr,lastFocus,option)}else{startFocus=option}}else{if(e.ctrlKey&&vList.indexOf(option.dataset[valueKey])>-1){option.classList.remove("ds-checked")}else{resetLastFocus(ele,option);option.classList.add("ds-checked")}}}else{if(!e.ctrlKey||vList.indexOf(option.dataset[valueKey])<0){option.classList.remove("ds-checked")}}}if(startFocus&&lastFocus){addSelect(arr,startFocus,lastFocus)}else{if(startFocus&&lastFocus===null&&arr[0]){addSelect(arr,arr[0],startFocus)}}}function getValue(ele,data){if(data&&data.callBack){eleList=ele.getElementsByClassName("ds-checked");vList=[];for(var i=0;i<eleList.length;i++){vList.push(eleList[i].dataset[valueKey])}data.callBack(vList,eleList)}}function DS(ele,data,s){isReduce=!!s;if(ele){valueKey=data.value||"value";function clickFun(e,flag){var e=e||window.event;ele.onmousemove=null;document.onclick=null;setShage(e,ele,flag);getValue(ele,data);try{ele.removeChild(shade)}catch(error){console.log(error)}}ele.onmousedown=function(e){var e=e||window.event;if(e.button!=0){return}clearSelections();sX=e.pageX-getEleOffsetLeft(ele)+getEleScrollLeft(ele)-(isReduce?window.scrollX:0);sY=e.pageY-getEleOffsetTop(ele)+getEleScrollTop(ele)-(isReduce?window.scrollY:0);if(e.target.draggable){document.onclick=function(e){clickFun(e)};return}ele.appendChild(shade);setShage(e,ele);ele.onmousemove=function(e){var e=e||window.event;setShage(e,ele)};document.onclick=clickFun}}}function cancelDS(ele){ele.onmousedown=null;ele.onmousemove=null;document.onclick=null}DS.cancelDS=cancelDS;return DS};
